"use strict";(self.webpackChunkchg_training_resources=self.webpackChunkchg_training_resources||[]).push([[290],{3905:(a,e,t)=>{t.d(e,{Zo:()=>l,kt:()=>d});var n=t(67294);function s(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function r(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function m(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?r(Object(t),!0).forEach((function(e){s(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function p(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},r=Object.keys(a);for(n=0;n<r.length;n++)t=r[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(n=0;n<r.length;n++)t=r[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}var i=n.createContext({}),o=function(a){var e=n.useContext(i),t=e;return a&&(t="function"==typeof a?a(e):m(m({},e),a)),t},l=function(a){var e=o(a.components);return n.createElement(i.Provider,{value:e},a.children)},c="mdxType",N={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},h=n.forwardRef((function(a,e){var t=a.components,s=a.mdxType,r=a.originalType,i=a.parentName,l=p(a,["components","mdxType","originalType","parentName"]),c=o(t),h=s,d=c["".concat(i,".").concat(h)]||c[h]||N[h]||r;return t?n.createElement(d,m(m({ref:e},l),{},{components:t})):n.createElement(d,m({ref:e},l))}));function d(a,e){var t=arguments,s=e&&e.mdxType;if("string"==typeof a||s){var r=t.length,m=new Array(r);m[0]=h;var p={};for(var i in e)hasOwnProperty.call(e,i)&&(p[i]=e[i]);p.originalType=a,p[c]="string"==typeof a?a:s,m[1]=p;for(var o=2;o<r;o++)m[o]=t[o];return n.createElement.apply(null,m)}return n.createElement.apply(null,t)}h.displayName="MDXCreateElement"},13266:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>m,default:()=>N,frontMatter:()=>r,metadata:()=>p,toc:()=>o});var n=t(87462),s=(t(67294),t(3905));const r={sidebar_position:6.5},m="Part 2: Transforming the phenotype data",p={unversionedId:"genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc",id:"genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc",title:"Part 2: Transforming the phenotype data",description:"Most commonly-used GWAS software implement",source:"@site/docs/genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc.md",sourceDirName:"genome_wide_association_studies/quantitative_trait_gwas",slug:"/genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc",permalink:"/chg-training-resources/genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc",draft:!1,editUrl:"https://github.com/chg-training/chg-training-resources/edit/main/docs/genome_wide_association_studies/quantitative_trait_gwas/phenotype_qc.md",tags:[],version:"current",sidebarPosition:6.5,frontMatter:{sidebar_position:6.5},sidebar:"sidebar8",previous:{title:"Aside: excluding related samples",permalink:"/chg-training-resources/genome_wide_association_studies/quantitative_trait_gwas/sample_relatedness"},next:{title:"Part 3: Running a simple regression analysis",permalink:"/chg-training-resources/genome_wide_association_studies/quantitative_trait_gwas/testing_for_association"}},i={},o=[{value:"Next steps",id:"next-steps",level:2}],l={toc:o},c="wrapper";function N(a){let{components:e,...r}=a;return(0,s.kt)(c,(0,n.Z)({},l,r,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"part-2-transforming-the-phenotype-data"},"Part 2: Transforming the phenotype data"),(0,s.kt)("p",null,"Most commonly-used GWAS software implement\n",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/statistical_modelling/regression_modelling/logistic_regression_1"},"logistic")," or ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/statistical_modelling/regression_modelling/linear_regression_1"},"linear\nregression")," models to determine whether a SNP\nis associated with the trait of interest.  Logistic models are used for categorical trait data such as case-control\nstudies, while linear models are used for continuous trait data (e.g. height).  Here, we will analyse a quantitative\nphenotype (antibody response to Norovirus) so will focus on a linear model."),(0,s.kt)("p",null,"##\xa0Dealing with non-normality"),(0,s.kt)("p",null,"Linear models rely on the assumption that the residuals (difference between observed and predicted dependent variable)\nare normally distributed. To ensure that this assumption is met, it is important to know the distribution of the data,\nand deal with any non-normality.  The simplest way to do that is to use a transformation to normalise the trait\ndata (if needed).  "),(0,s.kt)("p",null,"To check whether the data follows a normal distribution, we will first generate a histogram of the data with R along\nwith measurements for how close to normal the distribution is This will tell us about the spread of the values and whether there may be any\nunusually high or low readings (outliers) that might bias the results. A normal distribution should follow a regular\ncurve like this:"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(41207).Z,width:"432",height:"288"})),(0,s.kt)("p",null,"But our antibody response data looks like this:"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(85465).Z,width:"432",height:"288"})),(0,s.kt)("p",null,"As you can see, our data is not quite normally distributed."),(0,s.kt)("p",null,"At this point you have two options.  One is to go ahead and analyse anyway.  This has the major advantage that ",(0,s.kt)("strong",{parentName:"p"},"it does not change the scale of the data"),". (Thus, estimates are interpretable on the original antibody measurement scale.)  But it has the disadvantage that ",(0,s.kt)("strong",{parentName:"p"},"the model may be somewhat mis-specified")," meaning that its estimates, standard errors and P-values could be biased."),(0,s.kt)("p",null,"To solve this we will apply a transformation to the phenotype."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"What transformation?")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Two possible transformations you could try are: a ",(0,s.kt)("strong",{parentName:"p"},"log transformation"),":"),(0,s.kt)("div",{parentName:"div",className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"t"),(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mi",{parentName:"mrow"},"a"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"s"),(0,s.kt)("mi",{parentName:"mrow"},"f"),(0,s.kt)("mi",{parentName:"mrow"},"o"),(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mi",{parentName:"mrow"},"m"),(0,s.kt)("mi",{parentName:"mrow"},"e"),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"d"),(0,s.kt)("mi",{parentName:"msub"},"y")),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mi",{parentName:"mrow"},"log"),(0,s.kt)("mo",{parentName:"mrow"},"\u2061"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"y"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"transformed_y = \\log(y)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"y")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mop"},"lo",(0,s.kt)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))),(0,s.kt)("p",{parentName:"div"},"The log transformation simply transforms values by the log function (which tends to stretch out values more, the closer\nto zero they are)."),(0,s.kt)("p",{parentName:"div"},"Or a ",(0,s.kt)("strong",{parentName:"p"},"quantile normalisation")," transformation:"),(0,s.kt)("div",{parentName:"div",className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"t"),(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mi",{parentName:"mrow"},"a"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"s"),(0,s.kt)("mi",{parentName:"mrow"},"f"),(0,s.kt)("mi",{parentName:"mrow"},"o"),(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mi",{parentName:"mrow"},"m"),(0,s.kt)("mi",{parentName:"mrow"},"e"),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"d"),(0,s.kt)("mi",{parentName:"msub"},"y")),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup",mathvariant:"normal"},"\u03a6"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"1"))),(0,s.kt)("mrow",{parentName:"mrow"},(0,s.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,s.kt)("mtext",{parentName:"mrow"},"rank"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"y"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow",fence:"true"},")"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"transformed_y = \\Phi^{-1} \\left( \\text{rank}(y) \\right)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"y")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.1141em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"\u03a6"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8641em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))))))),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"minner"},(0,s.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},"("),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"rank")),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},")"))))))),(0,s.kt)("p",{parentName:"div"},"where ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup",mathvariant:"normal"},"\u03a6"),(0,s.kt)("mo",{parentName:"msup"},"\u2212")),(0,s.kt)("mn",{parentName:"mrow"},"1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\Phi^-1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7713em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"\u03a6"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.7713em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212")))))))),(0,s.kt)("span",{parentName:"span",className:"mord"},"1")))))," means the ",(0,s.kt)("strong",{parentName:"p"},"quantile function")," of the normal distribution.  (See the ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/statistical_modelling/probability_cheatsheet"},"probability\ncheatsheet")," if you're unsure of what this is.)"))),(0,s.kt)("p",null,"Load the data into R or python, e.g:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-r"},'# in R\ndata = readr::read_tsv( "Phenotype_data/AMR_phenotype.txt" )\n')),(0,s.kt)("p",null,"...and plot a histogram for the data or after applying the above transformations. "),(0,s.kt)("p",null,"For example in R, the quantile normalisation can be applied using this function, which also handles missing values:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-r"},'quantile_normalise = function( y ) {\n    return(\n        qnorm(\n            ( rank( y, na.last = "keep" ) - 0.5 )\n            / sum( !is.na(y) )\n        )\n    )\n}\n')),(0,s.kt)("p",null,"Which transformation might be most suitable the phenotype data associated with these datasets?"),(0,s.kt)("p",null,":::"),(0,s.kt)("p",null,"##\xa0Applying the transformation"),(0,s.kt)("p",null,"Let's apply the quantile normalisation transformation now. Try this code:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-r"},'library(ggplot2)\n\nquantile_normalise = function( y ) {\n    return(\n        qnorm(\n            ( rank( y, na.last = "keep" ) - 0.5 )\n            / sum( !is.na(y) )\n        )\n    )\n}\n\n# Read in the phenotype file \ndata <- readr::read_tsv( "Phenotype_data/AMR_phenotype.txt" )\n\n# Transform the antibody responses\ndata$Noro_response_INT <- quantile_normalise( data$Noro_response )\n\n# Generate the histogram using the phenotype (Noro_response) column\np = (\n    ggplot(\n        data = data,\n        mapping = aes( x = Noro_response_INT )\n    )\n    + geom_histogram( binwidth=0.1 )\n    + labs(\n        title = "Transformed antibody responses to Norovirus",\n        x = "Antibody response",\n        y = "count"\n    )\n)\nprint(p)\n# Let\'s save the plot too...\nggsave( p, file = "AMR.Norovirus_response.INT.png" )\n\n# ...and write new data to file\nreadr::write_tsv(\n    data,\n    file = "Phenotype_data/AMR_phenotype.INT_transformed.txt"\n)\n\n')),(0,s.kt)("h2",{id:"next-steps"},"Next steps"),(0,s.kt)("p",null,"Ok!  You're ready to ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/genome_wide_association_studies/quantitative_trait_gwas/testing_for_association"},"test for association GWAS")))}N.isMDXComponent=!0},85465:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/antibody_response_distribution-29908d7ea04b240f04ff30dc0cd63251.png"},41207:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/normal_distribution-0b3dfbe1ee5f6622e4e2528899b21358.png"}}]);