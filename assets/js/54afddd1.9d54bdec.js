"use strict";(self.webpackChunkchg_training_resources=self.webpackChunkchg_training_resources||[]).push([[8777],{3905:(a,e,t)=>{t.d(e,{Zo:()=>o,kt:()=>d});var n=t(67294);function s(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function m(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function r(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){s(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function i(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},m=Object.keys(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}var p=n.createContext({}),l=function(a){var e=n.useContext(p),t=e;return a&&(t="function"==typeof a?a(e):r(r({},e),a)),t},o=function(a){var e=l(a.components);return n.createElement(p.Provider,{value:e},a.children)},h="mdxType",c={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},N=n.forwardRef((function(a,e){var t=a.components,s=a.mdxType,m=a.originalType,p=a.parentName,o=i(a,["components","mdxType","originalType","parentName"]),h=l(t),N=s,d=h["".concat(p,".").concat(N)]||h[N]||c[N]||m;return t?n.createElement(d,r(r({ref:e},o),{},{components:t})):n.createElement(d,r({ref:e},o))}));function d(a,e){var t=arguments,s=e&&e.mdxType;if("string"==typeof a||s){var m=t.length,r=new Array(m);r[0]=N;var i={};for(var p in e)hasOwnProperty.call(e,p)&&(i[p]=e[p]);i.originalType=a,i[h]="string"==typeof a?a:s,r[1]=i;for(var l=2;l<m;l++)r[l]=t[l];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}N.displayName="MDXCreateElement"},72360:(a,e,t)=>{t.d(e,{Z:()=>r});var n=t(67294),s=t(86010);const m={tabItem:"tabItem_OmH5"};function r(a){let{children:e,hidden:t,className:r}=a;return n.createElement("div",{role:"tabpanel",className:(0,s.Z)(m.tabItem,r),hidden:t},e)}},9877:(a,e,t)=>{t.d(e,{Z:()=>c});var n=t(87462),s=t(67294),m=t(72389),r=t(67392),i=t(7094),p=t(12466),l=t(86010);const o={tabList:"tabList_uSqn",tabItem:"tabItem_LplD"};function h(a){const{lazy:e,block:t,defaultValue:m,values:h,groupId:c,className:N}=a,d=s.Children.map(a.children,(a=>{if((0,s.isValidElement)(a)&&void 0!==a.props.value)return a;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof a.type?a.type:a.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=h??d.map((a=>{let{props:{value:e,label:t,attributes:n}}=a;return{value:e,label:t,attributes:n}})),g=(0,r.l)(k,((a,e)=>a.value===e.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((a=>a.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const u=null===m?m:m??d.find((a=>a.props.default))?.props.value??d[0]?.props.value;if(null!==u&&!k.some((a=>a.value===u)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${u}" but none of its children has the corresponding value. Available values are: ${k.map((a=>a.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:w}=(0,i.U)(),[y,x]=(0,s.useState)(u),f=[],{blockElementScrollPositionUntilNextRender:b}=(0,p.o5)();if(null!=c){const a=v[c];null!=a&&a!==y&&k.some((e=>e.value===a))&&x(a)}const _=a=>{const e=a.currentTarget,t=f.indexOf(e),n=k[t].value;n!==y&&(b(e),x(n),null!=c&&w(c,n))},M=a=>{let e=null;switch(a.key){case"ArrowRight":{const t=f.indexOf(a.currentTarget)+1;e=f[t]||f[0];break}case"ArrowLeft":{const t=f.indexOf(a.currentTarget)-1;e=f[t]||f[f.length-1];break}}e?.focus()};return s.createElement("div",{className:(0,l.Z)("tabs-container",o.tabList)},s.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},N)},k.map((a=>{let{value:e,label:t,attributes:m}=a;return s.createElement("li",(0,n.Z)({role:"tab",tabIndex:y===e?0:-1,"aria-selected":y===e,key:e,ref:a=>f.push(a),onKeyDown:M,onFocus:_,onClick:_},m,{className:(0,l.Z)("tabs__item",o.tabItem,m?.className,{"tabs__item--active":y===e})}),t??e)}))),e?(0,s.cloneElement)(d.filter((a=>a.props.value===y))[0],{className:"margin-top--md"}):s.createElement("div",{className:"margin-top--md"},d.map(((a,e)=>(0,s.cloneElement)(a,{key:e,hidden:a.props.value!==y})))))}function c(a){const e=(0,m.Z)();return s.createElement(h,(0,n.Z)({key:String(e)},a))}},59183:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>p,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>h});var n=t(87462),s=(t(67294),t(3905)),m=t(9877),r=t(72360);const i={sidebar_position:1},p="A linear regression example",l={unversionedId:"statistical_modelling/regression_modelling/linear_regression_1",id:"statistical_modelling/regression_modelling/linear_regression_1",title:"A linear regression example",description:"Prerequisites",source:"@site/docs/statistical_modelling/regression_modelling/linear_regression_1.md",sourceDirName:"statistical_modelling/regression_modelling",slug:"/statistical_modelling/regression_modelling/linear_regression_1",permalink:"/chg-training-resources/statistical_modelling/regression_modelling/linear_regression_1",draft:!1,editUrl:"https://github.com/chg-training/chg-training-resources/edit/main/docs/statistical_modelling/regression_modelling/linear_regression_1.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"sidebar6",previous:{title:"Modelling statistical association with regression",permalink:"/chg-training-resources/statistical_modelling/regression_modelling/"},next:{title:"Linear regression cheatsheet",permalink:"/chg-training-resources/statistical_modelling/regression_modelling/linear_regression_cheatsheet"}},o={},h=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Getting the data",id:"getting-the-data",level:3},{value:"What&#39;s in the data?",id:"whats-in-the-data",level:3},{value:"Quick look at the genotypes:",id:"quick-look-at-the-genotypes",level:3},{value:"Is rs1419114 associated with <em>ATP2B4</em> expression?",id:"is-rs1419114-associated-with-atp2b4-expression",level:2},{value:"Plotting the relationship",id:"plotting-the-relationship",level:3},{value:"Normalising read counts",id:"normalising-read-counts",level:3},{value:"Running a regression",id:"running-a-regression",level:3},{value:"Interpreting the regression",id:"interpreting-the-regression",level:3},{value:"P-values, standard errors and all that",id:"p-values-standard-errors-and-all-that",level:3},{value:"Including covariates",id:"including-covariates",level:3},{value:"How good is the fit?",id:"how-good-is-the-fit",level:3},{value:"Next steps",id:"next-steps",level:2}],c={toc:h},N="wrapper";function d(a){let{components:e,...i}=a;return(0,s.kt)(N,(0,n.Z)({},c,i,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"a-linear-regression-example"},"A linear regression example"),(0,s.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,s.kt)("p",null,"For this tutorial you will need to have ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/prerequisites/R"},"installed R and Rstudio"),". We will use R to analyse some expression\ndata.  I'll also be using the ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/prerequisites/tidyverse"},"tidyverse")," in examples."),(0,s.kt)("h3",{id:"getting-the-data"},"Getting the data"),(0,s.kt)("p",null,"In this part of the practical we will use linear regression to estimate the possible effect of a genotype on gene expression\nvalues. To get started, create a new empty directory and change into it:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"mkdir regression_tutorial\ncd regression_tutorial\n")),(0,s.kt)("p",null,"The data can be found in ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/chg-training/chg-training-resources/tree/main/docs/statistical_modelling/regression_modelling/data/"},"this\nfolder")," -\ndownload the file ",(0,s.kt)("inlineCode",{parentName:"p"},"atp2b4_per_gene_data.tsv")," and place it in your folder:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"curl -O https://raw.githubusercontent.com/chg-training/chg-training-resources/main/docs/statistical_modelling/regression_modelling/data/atp2b4_per_gene_data.tsv\n")),(0,s.kt)("p",null,"(Or use the ",(0,s.kt)("a",{target:"_blank",href:t(25101).Z},"direct link"),".)"),(0,s.kt)("p",null,"Start an R session and make sure you are working in this directory (e.g. using ",(0,s.kt)("inlineCode",{parentName:"p"},"setwd()")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"Session")," -> ",(0,s.kt)("inlineCode",{parentName:"p"},"Set Working Directory"),"\nin RStudio).  Let's load the data now and take a look:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'library( tidyverse )\ndata = read_delim( "atp2b4_per_gene_data.tsv", delim = "\\t" )\n')),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"I am using the ",(0,s.kt)("a",{parentName:"p",href:"https://www.tidyverse.org"},"tidyverse")," for these examples. If you don't\nhave it installed, either install it or use base R (e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"read.delim()"),") instead."))),(0,s.kt)("h3",{id:"whats-in-the-data"},"What's in the data?"),(0,s.kt)("p",null,"The data represents gene expression values (expressed as the mean number of RNA-seq reads per base, averaged across the gene\nexons) for the gene ",(0,s.kt)("em",{parentName:"p"},"ATP2B4"),". The data comes from ",(0,s.kt)("a",{parentName:"p",href:"https://doi.org/10.1172/JCI94378"},"this paper")," which reported that local\ngenotypes - including at the SNP rs1419114 - are associated with expression changes. Let's see if we can reconstruct this."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Gene quantification is usually measured in more sophisticated units - 'transcripts per million' (TPM) or 'fragments per\nkilobase per million'`(FPKM). They involve scaling by the computed value across all genes, which helps to normalise for\nvariation in expression of other genes.   We'll skip that here but you should consider it if doing a real transcriptomic\nstudy."))),(0,s.kt)("h3",{id:"quick-look-at-the-genotypes"},"Quick look at the genotypes:"),(0,s.kt)("p",null,"First let's rename the genotype column - too long!"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'colnames(data)[4] = "genotype"\n')),(0,s.kt)("p",null,"Let's look at this column now:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"table(data$genotype)\n")),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Question")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"How many samples are in the data?  How many of each genotype?"))),(0,s.kt)("p",null,"There's only one A/A genotype in the data. This might look a bit odd at first, but if you look up rs1419114 on\n",(0,s.kt)("a",{parentName:"p",href:"https://ensembl.org"},"https://ensembl.org")," you'll see why. The frequency of the ",(0,s.kt)("inlineCode",{parentName:"p"},"A")," allele in non-African populations is around ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mfrac",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"mfrac"},"1"),(0,s.kt)("mn",{parentName:"mfrac"},"10"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\frac{1}{10}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,s.kt)("span",{parentName:"span",className:"mfrac"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8451em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.655em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"10")))),(0,s.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,s.kt)("span",{parentName:"span",style:{top:"-3.394em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,s.kt)("span",{parentName:"span"}))))),(0,s.kt)("span",{parentName:"span",className:"mclose nulldelimiter"}))))))," or\nless. So assuming the two chromosomes are drawn independently we'd only expect about ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"24"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mfrac",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"mfrac"},"1"),(0,s.kt)("mn",{parentName:"mfrac"},"100"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"24 \\times \\frac{1}{100}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"24"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.1901em",verticalAlign:"-0.345em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,s.kt)("span",{parentName:"span",className:"mfrac"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8451em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.655em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"100")))),(0,s.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,s.kt)("span",{parentName:"span",style:{top:"-3.394em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.345em"}},(0,s.kt)("span",{parentName:"span"}))))),(0,s.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})))))),", so not so\nsurprising we got only one."),(0,s.kt)("h2",{id:"is-rs1419114-associated-with-atp2b4-expression"},"Is rs1419114 associated with ",(0,s.kt)("em",{parentName:"h2"},"ATP2B4")," expression?"),(0,s.kt)("h3",{id:"plotting-the-relationship"},"Plotting the relationship"),(0,s.kt)("p",null,"The best way to start figuring this out is by plotting:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'library( ggplot2 )\n(\n    ggplot( data = data, aes( x = genotype, y = mean_reads_per_base ))\n    + geom_violin()\n    + geom_point()\n    + xlab( "rs1419114 genotype" )\n    + ylab( "Reads per base")\n)\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(93754).Z,width:"600",height:"400"})),(0,s.kt)("p",null,"Hmm.  There looks visually like a correspondence.  "),(0,s.kt)("p",null,"But wait!  Maybe that's just to do with how many reads were sequenced?"),(0,s.kt)("h3",{id:"normalising-read-counts"},"Normalising read counts"),(0,s.kt)("p",null,"Different runs of the sequencer produce different numbers of reads due to prosaic features to do with library preparation and\nreagents and so on - producing variation in the counts that has nothing to do with biology.  So let's normalise by this number now:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-R"},"data$reads_per_base_per_million = 1E6 * data$mean_reads_per_base / data$total_reads\n")),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"I included added a factor of 1 million here just to bring the values back into roughly the right level. The values are the\n",(0,s.kt)("em",{parentName:"p"},"number of reads per base of the gene per million sequenced reads"),"."),(0,s.kt)("p",{parentName:"div"},"For most work of this type you should probably compute ",(0,s.kt)("strong",{parentName:"p"},"TPM")," instead, which ",(0,s.kt)("em",{parentName:"p"},"also")," normalises by gene length.  It is an estimate of the proportion of expressed transcripts from that gene. However, we're only interested in one gene here, so we'll stick with this value."))),(0,s.kt)("p",null,"Let's plot again:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'p = (\n    ggplot( data = data, aes( x = genotype, y = reads_per_base_per_million ))\n    + geom_violin()\n    + geom_point()\n    + xlab( "rs1419114 genotype" )\n    + ylab( "Reads per base per million sequenced reads")\n)\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(38803).Z,width:"600",height:"400"})),(0,s.kt)("p",null,"It ",(0,s.kt)("em",{parentName:"p"},"still")," looks visually like there's a relationship."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Expression values are often explored after log-transforming them.  What difference does that make here?"))),(0,s.kt)("p",null,"In what follows I will use 'expression' to mean these normalised expression values - just remember that these are a transformed\nmeasurement of the actual expression of the gene."),(0,s.kt)("h3",{id:"running-a-regression"},"Running a regression"),(0,s.kt)("p",null,"Now let's estimate the relationship between genotype and mRNA expression by fitting a ",(0,s.kt)("strong",{parentName:"p"},"linear regression model"),"."),(0,s.kt)("p",null,"To start off let's recode our genotype by the number of ",(0,s.kt)("strong",{parentName:"p"},"G")," alleles:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"data$dosage = 0\ndata$dosage[ data$genotype == 'A/G' ] = 1\ndata$dosage[ data$genotype == 'G/G' ] = 2\ndata$dosage = as.integer( data$dosage )\ntable( data$dosage )\n")),(0,s.kt)("p",null,"In R it's easy to fit a linear regression model: use ",(0,s.kt)("inlineCode",{parentName:"p"},"lm()"),":"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"fit = lm(\n    reads_per_base_per_million ~ dosage,\n    data = data\n)\n")),(0,s.kt)("p",null,"The best way to look at the result of this is to use the ",(0,s.kt)("inlineCode",{parentName:"p"},"summary()")," command to pull out the estimated coefficients and standard\nerrors. You can do that like this:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"summary(fit)$coefficients\n")),(0,s.kt)("p",null,"This will probably produce something like this:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"              Estimate Std. Error  t value  Pr(>|t|)\n(Intercept) 0.04981156 0.02097038 2.375329 0.0266714\ndosage      0.02090930 0.01245827 1.678347 0.1074296\n")),(0,s.kt)("p",null,"To make sense of this, you have to understand something about the model that is being fit. In math syntax it can be written as\nfollows:"),(0,s.kt)("div",{className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow"},"expression\xa0level"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mi",{parentName:"mrow"},"\u03bc"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mtext",{parentName:"mrow"},"genotype"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mrow",{parentName:"mrow"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"gaussian"),(0,s.kt)("mtext",{parentName:"mrow"},"\xa0"),(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"noise"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{expression level} = \\mu + \\beta \\times \\text{genotype} + \\text{\\textit{gaussian noise}}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"expression\xa0level")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03bc"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"genotype")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8623em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"gaussian\xa0noise")))))))),(0,s.kt)("p",null,"Here ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03bc")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\mu")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03bc")))))," and ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," are the two parameters (output in the two rows above) - ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03bc")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\mu")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03bc")))))," is the ",(0,s.kt)("em",{parentName:"p"},"intercept"),", which captures the\naverage expression values; and ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," is the ",(0,s.kt)("em",{parentName:"p"},"regression effect size parameter"),". "),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," should therefore be interpreted as: the estimated increase in expression associated with each additional copy of the 'G'\nallele. It is often called the ",(0,s.kt)("em",{parentName:"p"},"association effect size"),"."))),(0,s.kt)("p",null,"All ",(0,s.kt)("inlineCode",{parentName:"p"},"lm")," does is find the values of ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03bc")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\mu")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03bc")))))," and ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," which best fit the data."),(0,s.kt)("h3",{id:"interpreting-the-regression"},"Interpreting the regression"),(0,s.kt)("p",null,"So what does this output say?  It says that:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"the estimated mean expression level is ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0498")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0498")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0498"))))),"."),(0,s.kt)("li",{parentName:"ul"},"the ",(0,s.kt)("em",{parentName:"li"},"standard error")," of this estimate is ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0210")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0210")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0210"))))),"."),(0,s.kt)("li",{parentName:"ul"},"the estimated ",(0,s.kt)("em",{parentName:"li"},"association effect size")," - that is, the estimated increase in expression with each copy of the 'G' allele - is ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0209")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0209")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0209"))))),"."),(0,s.kt)("li",{parentName:"ul"},"the standard error of this estimate is ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0125")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0125")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0125"))))),".")),(0,s.kt)("p",null,"Let's plot this on the above graph:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'p = (\n    ggplot( data = data, aes( x = dosage, y = reads_per_base_per_million ) )\n    + geom_point()\n    + xlab( "rs1419114 genotype" )\n    + ylab( "Reads per base per million reads")\n    + geom_abline( intercept = 0.0498, slope = 0.0209, col = \'red\' )\n)\nprint(p)\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Important"),". The regression estimate of ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," is the ",(0,s.kt)("em",{parentName:"p"},"slope")," of fitted line."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Question")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Which of these statements do you agree with?"),(0,s.kt)("ul",{parentName:"div"},(0,s.kt)("li",{parentName:"ul"},"The rs1419114 'G' allele is associated with increased expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),"."),(0,s.kt)("li",{parentName:"ul"},"The rs1419114 'G' allele is not associated with increased expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),"."),(0,s.kt)("li",{parentName:"ul"},"We can't tell from these data if rs1419114 is associated with expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),".")))),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Visualising the fit")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"If you did the ",(0,s.kt)("a",{parentName:"p",href:"/data_visualisation/data_visualisation_with_ggplot2/"},"visualisation tutorial")," you will have seen a method to get\nggplot2 to add a regression line and confidence interval (using ",(0,s.kt)("inlineCode",{parentName:"p"},"geom_smooth()"),"). How is that added?"),(0,s.kt)("p",{parentName:"div"},"The calculation can be done using ",(0,s.kt)("inlineCode",{parentName:"p"},"predict"),". Specifically let's get it to predict the values and upper and lower confidence\nintervals at a range of values from 0 to 2:"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"x = seq( from = 0, to = 2, by = 0.01 )\ninterval = predict(\n    fit,\n    newdata = data.frame( dosage = x ),\n    interval = \"confidence\",\n    level = 0.95\n)\n\ninterval_data = tibble(\n    x = x,\n    lower = interval[,'lwr'],\n    upper = interval[,'upr']\n)\nprint(\n    p\n    + geom_line( data = interval_data, aes( x = x, y = lower ))\n    + geom_line( data = interval_data, aes( x = x, y = upper ))\n)\n")),(0,s.kt)("p",{parentName:"div"},(0,s.kt)("img",{alt:"img",src:t(73975).Z,width:"400",height:"300"})),(0,s.kt)("p",{parentName:"div"},"Compare this with ",(0,s.kt)("inlineCode",{parentName:"p"},"geom_smooth"),":"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},'p + geom_smooth( method = "lm" )\n')),(0,s.kt)("p",{parentName:"div"},(0,s.kt)("img",{alt:"img",src:t(61347).Z,width:"400",height:"300"})),(0,s.kt)("p",{parentName:"div"},"They do... exactly the same thing!"),(0,s.kt)("p",{parentName:"div"},"Aside: If you want to get the cool shading from the ",(0,s.kt)("inlineCode",{parentName:"p"},"predict")," method, that's doable too:"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"transparent_grey = rgb( 0, 0, 0, 0.2 )\nprint(\n    p\n    + geom_ribbon(\n        data = interval_data,\n        # need to set y here even though not used\n        aes( x = x, y = 0, ymin = lower, ymax = upper ),\n        fill = transparent_grey\n    )\n)\n")),(0,s.kt)("p",{parentName:"div"},"Yet another way to do this is to ",(0,s.kt)("strong",{parentName:"p"},"sample some regression lines")," from the model fit. This is easy with a bit of an approximation.\nFirst get the variance-covariance matrix of the parameter estimates:"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"V = vcov(fit)\n")),(0,s.kt)("p",{parentName:"div"},"Now sample some regression lines from the fitted parameter distribution. To do this let's approximate it by a multivariate\ngaussian. The sampling can be done using the ",(0,s.kt)("inlineCode",{parentName:"p"},"mvtnorm")," package:"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"library( mvtnorm )\nsampled_lines = rmvnorm( 100, sigma = V, mean = c( 0.0498, 0.0209 ) )\n\n")),(0,s.kt)("p",{parentName:"div"},"Now let's add those sampled lines to the plot:"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"sampled_lines = tibble(\n    a = sampled_lines[,1],\n    b = sampled_lines[,2]\n)\nprint(\n    p\n    + geom_abline(\n        data = sampled_lines,\n        aes(\n            intercept = a,\n            slope = b\n        ),\n        col = rgb( 0, 0, 0, 0.1 )\n    )\n    + theme_minimal(16) # simpler theme, to make it easier to see\n)\n")),(0,s.kt)("p",{parentName:"div"},"Congratulations!  You've added 100 samples from the (approximate) posterior distribution to the plot.\n(What happens if you turn up the number of lines?)"),(0,s.kt)("p",{parentName:"div"},(0,s.kt)("strong",{parentName:"p"},"Note.")," This last way of plotting the regression confidence interval is helpful because it reveals how we think of the regression\nfit: namely it determines a ",(0,s.kt)("em",{parentName:"p"},"joint distribution over the parameters"),"."))),(0,s.kt)("h3",{id:"p-values-standard-errors-and-all-that"},"P-values, standard errors and all that"),(0,s.kt)("p",null,"In the above, the estimate was ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0209")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0209")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0209")))))," with a standard error of ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0125")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0125")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0125"))))),".  What does that standard error mean?"),(0,s.kt)("p",null,"Here are two ways of thinking about it.  First, a ",(0,s.kt)("strong",{parentName:"p"},"bayesian")," interpretation is that this is telling us the approximate\n",(0,s.kt)("strong",{parentName:"p"},"posterior distribution of the parameter")," - that is, what we should believe about the parameter having seen the data.\n(In this setting, we have to have assumed ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow"},"prior"),(0,s.kt)("mo",{parentName:"mrow"},"\u2261"),(0,s.kt)("mn",{parentName:"mrow"},"1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{prior}\\equiv 1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8623em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"prior")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2261"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1")))))," so that the prior doesn't affect things.).  Although\nthe true posterior could be mathematically complex, it's approximately normal with that standard error."),(0,s.kt)("p",null,"Second, a ",(0,s.kt)("strong",{parentName:"p"},"frequentist")," interpretation is that the standard error tells us about the ",(0,s.kt)("strong",{parentName:"p"},"sampling distribution")," of\nthe estimate.  To understand this, you have to think not just of the dataset we have loaded, but also imagine what would\nhappen if we (hypothetically) generated lots of other datasets in the same way and re-estimated. Each dataset would\ngenerate its own estimate, which would differ a bit from our estimate due to all the random noise and so on.  The\n",(0,s.kt)("strong",{parentName:"p"},"standard error")," tells us how much variability we should expect in that estimate.  Approximately, we can think of this\nas saying that the ",(0,s.kt)("strong",{parentName:"p"},"sampling distribution of the estimate")," is gaussian with that standard deviation."),(0,s.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The ",(0,s.kt)("strong",{parentName:"p"},"posterior distribution of the parameters"),", and the ",(0,s.kt)("strong",{parentName:"p"},"sampling distribution of the estimate"),", are not exactly the\nsame. But when there's lots of data they become ",(0,s.kt)("em",{parentName:"p"},"approximately")," the same (and both approximately normal) and so for most\npurposes we can treat them as the same."))),(0,s.kt)("p",null,"To explore this ",(0,s.kt)("strong",{parentName:"p"},"sampling distribution")," interpretation, suppose there's actually no association and suppose -\nhypothetically - we were to repeat the study a zillion times, each time taking a different set of 24 samples (with the\nsame genotypes but different expression measurements). The ",(0,s.kt)("em",{parentName:"p"},"sampling distribution")," of the estimate we would obtain would\nthen look approximately like a normal distribution with ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow"},"sd"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"0.01245827")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{sd}=0.01245827")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"sd")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.01245827")))))," - that is, like this:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'sampling_distribution = (\n    tibble(\n        x = seq( from = -0.1, to = 0.1, by = 0.001 )\n    )\n    %>% mutate(\n        density = dnorm( x, mean = 0, sd = 0.01245827 )\n    )\n)\n\np2 = (\n    ggplot( data = sampling_distribution )\n    + geom_line( aes( x = x, y = density ) )\n    + geom_vline( xintercept = 0.0209, linetype = 2 )\n    + geom_text( x = 0.0209, y = 30, label = "observed estimate", hjust = -0.1 )\n    + xlab( "estimate" )\n    + ylab( "density" )\n)\nprint(p2)\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(48260).Z,width:"400",height:"300"})),(0,s.kt)("p",null,"What this is saying is: our estimate is fairly well within the distribution that would be expected if there is no true association.\nWhichever way you look at this it's hard to get excited about the association."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"The P-value")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The P-value gives ",(0,s.kt)("strong",{parentName:"p"},"no more information")," than the beta and standard error."),(0,s.kt)("p",{parentName:"div"},"In fact, it is computed as the mass of the sampling distribution shown above that is 'larger' than the observed beta\nestimate, like this:"),(0,s.kt)("p",{parentName:"div"},(0,s.kt)("img",{alt:"img",src:t(28723).Z,width:"400",height:"300"})),(0,s.kt)("p",{parentName:"div"},"As the plot shows, the P-value that ",(0,s.kt)("inlineCode",{parentName:"p"},"lm()")," reports is a ",(0,s.kt)("strong",{parentName:"p"},"two-tailed")," p-value, meaning that it accounts for all values\nthat are ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow"},">"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,s.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"> |\\beta|")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},">"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,s.kt)("span",{parentName:"span",className:"mord"},"\u2223")))))," (in either direction).  To compute it, just ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/statistical_modelling/introduction/quantiles_and_pvalues"},"compute this mass"),":"),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"print(\n    pnorm( -0.0209, mean = 0, sd = 0.0125 ) # mass under left tail\n    * 2                                     # get right tail too\n)\n")),(0,s.kt)("pre",{parentName:"div"},(0,s.kt)("code",{parentName:"pre"},"[1] 0.09452432\n")),(0,s.kt)("p",{parentName:"div"},"Because of this mass-under-the-tails definition, the p-value is interpreted as the probability of seeing an effect as\nlarge as ",(0,s.kt)("em",{parentName:"p"},"or larger than")," the one we actually saw, if there wasn't any true effect.  "),(0,s.kt)("p",{parentName:"div"},"The real point I am making here is that ",(0,s.kt)("strong",{parentName:"p"},"the P-value gives no new information relative to the estimate and its standard\nerror"),". If you had to choose what to report, it should be the estimate of ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," and its standard error, because you\ncan compute the P-value form that."))),(0,s.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Well not quite normal!")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},(0,s.kt)("strong",{parentName:"p"},"Note.")," The p-value computed using ",(0,s.kt)("inlineCode",{parentName:"p"},"pnorm()")," above (",(0,s.kt)("inlineCode",{parentName:"p"},"0.0095"),") is ",(0,s.kt)("em",{parentName:"p"},"almost")," but not quite the same as the one listed in the regression output.\nThat's because, for linear regression, the distribution is actually a ",(0,s.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Student's_t-distribution"},"T\ndistribution")," rather than gaussian."),(0,s.kt)("p",{parentName:"div"},"However"),(0,s.kt)("ul",{parentName:"div"},(0,s.kt)("li",{parentName:"ul"},"this doesn't matter much for most regression"),(0,s.kt)("li",{parentName:"ul"},"it gets less important as the sample size grows"),(0,s.kt)("li",{parentName:"ul"},"and it only really applies to linear regression")),(0,s.kt)("p",{parentName:"div"},"...so in most cases you won't go far wrong by thinking of it as computed using ",(0,s.kt)("inlineCode",{parentName:"p"},"pnorm()")," as above."))),(0,s.kt)("p",null,"In any case - whichever way you dice it, this association does not look very exciting, right?"),(0,s.kt)("h3",{id:"including-covariates"},"Including covariates"),(0,s.kt)("p",null,"But wait! There's another variable in the data. Specifically, the samples were either from bone marrow from adults or fetal liver.\nMaybe we should be including that in the regression?"),(0,s.kt)("p",null,"Including covariates is easy in linear regression - this is one of its great strengths.  Try it now:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-R"},"fit2 = lm(\n    reads_per_base_per_million ~ dosage + stage,\n    data = data\n)\nsummary(fit2)$coefficients\n")),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"What do these 'fetal' and 'adult' monikers mean? Well, mature red blood cells (erthrocytes) are ",(0,s.kt)("em",{parentName:"p"},"enucleated")," - they don't have\nnuclei. They are basically bags of haemoglobin, and although there might be a few fragments of RNA floating around, it will be\npretty degraded.  They are not much good for an expression study."),(0,s.kt)("p",{parentName:"div"},"For this study the authors therefore instead worked with haematopoetic stem and progenitor cells (HSPCs) from fetal liver and adult\nbone marrow, and experimentally differentiated them into ",(0,s.kt)("em",{parentName:"p"},"proerythroblasts"),". They then measured expression in these still-nucleated\ncells."),(0,s.kt)("p",{parentName:"div"},"(This issue of needing to differentiate is why red cells are not found in many expression databases - such as\n",(0,s.kt)("a",{parentName:"p",href:"http://gtexportal.org/home/index.html"},"GTEx"),".)"))),(0,s.kt)("p",null,"Your fit might look something like this:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept)  0.04473606 0.01650016  2.711250 0.0130793191\ndosage       0.03918108 0.01086677  3.605588 0.0016614274\nstagefetal  -0.04770967 0.01241647 -3.842451 0.0009462768\n")),(0,s.kt)("p",null,"The model is now:"),(0,s.kt)("div",{className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow"},"expression"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mi",{parentName:"mrow"},"\u03bc"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mtext",{parentName:"mrow"},"genotype"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"\u03b3"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mtext",{parentName:"mrow"},"stage"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mrow",{parentName:"mrow"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"gaussian"),(0,s.kt)("mtext",{parentName:"mrow"},"\xa0"),(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"noise"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{expression} = \\mu + \\beta\\times\\text{genotype} + \\gamma \\times \\text{stage} + \\text{\\textit{gaussian noise}}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8623em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"expression")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03bc"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"genotype")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7778em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"stage")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8623em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"gaussian\xa0noise")))))))),(0,s.kt)("p",null,"and we have three parameter estimates.  "),(0,s.kt)("p",null,"What has happened?"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"The intercept has got slightly lower"),(0,s.kt)("li",{parentName:"ul"},"The estimate of ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," is now about twice as large"),(0,s.kt)("li",{parentName:"ul"},"The standard error of ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," is smaller"),(0,s.kt)("li",{parentName:"ul"},"And the new parameter for fetal/adult status, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"\u03b3")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\gamma")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"))))),", is negative.")),(0,s.kt)("p",null,"The parameter estimate for the genotype ",(0,s.kt)("inlineCode",{parentName:"p"},"dosage")," is now ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"0.0392")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"0.0392")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.0392")))))," - and that's now ",(0,s.kt)("em",{parentName:"p"},"four times the standard error"),". As the P-value\nshows that's way out in the tail of the sampling distribution."),(0,s.kt)(m.Z,{mdxType:"Tabs"},(0,s.kt)(r.Z,{value:"code",label:"Plot code",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'p = (\n    ggplot( data = data, aes( x = dosage, y = reads_per_base_per_million ) )\n    + geom_point()\n    + xlab( "rs1419114 genotype" )\n    + ylab( "Reads per base per million reads")\n    + geom_abline( intercept = 0.04473606, slope = 0.03918108, col = \'red\' )\n)\n\nsampled_lines = rmvnorm( 10000, sigma = vcov( fit2 ), mean = c( 0.04473606, 0.03918108, -0.04770967 ) )\nsampled_interval = tibble(\n    dosage = x,\n    lower = sapply( x, function(p) { quantile( sampled_lines[,1] + p * sampled_lines[,2], 0.025 ) } ),\n    upper = sapply( x, function(p) { quantile( sampled_lines[,1] + p * sampled_lines[,2], 0.975 ) } )\n)\nprint(\n    p\n    + geom_ribbon(\n        data = sampled_interval,\n        aes( x = dosage, y = 0, ymin = lower, ymax = upper ),\n        fill = transparent_grey\n    )\n)\n\n# Plot the tail distribution\nsampling_distribution = tibble(\n    x = seq( from = -0.05, to = 0.1, by = 0.001 )\n)\nsampling_distribution$density = dnorm( sampling_distribution$x, mean = 0, sd = 0.01086677 )\n\np2 = (\n    ggplot( data = sampling_distribution )\n    + geom_line( aes( x = x, y = density ) )\n    + geom_vline( xintercept = 0.03922, linetype = 2 )\n    + geom_text( x = 0.03922, y = 35, label = "estimate", hjust = -0.1 )\n    + xlab( "estimate" )\n    + ylab( "density" )\n)\n\nlower_tail = which( sampling_distribution$x <= -0.03922 )\nupper_tail = which( sampling_distribution$x >= 0.03922 )\n\nprint(\n    p2\n    + geom_area( data = sampling_distribution[ lower_tail, ], aes( x = x, y = density ), fill = transparent_grey )\n    + geom_area( data = sampling_distribution[ upper_tail, ], aes( x = x, y = density ), fill = transparent_grey )\n)\n\n'))),(0,s.kt)(r.Z,{value:"image",label:"Updated plot",default:!0,mdxType:"TabItem"},(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(27504).Z,width:"400",height:"300"}),"\n",(0,s.kt)("img",{alt:"img",src:t(83918).Z,width:"400",height:"300"})))),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Question")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Which of these statements do you agree with now?"),(0,s.kt)("ul",{parentName:"div"},(0,s.kt)("li",{parentName:"ul"},"The rs1419114 'G' allele is associated with increased expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),"."),(0,s.kt)("li",{parentName:"ul"},"The rs1419114 'G' allele is not associated with increased expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),"."),(0,s.kt)("li",{parentName:"ul"},"We can't tell from these data if rs1419114 is associated with expression of ",(0,s.kt)("em",{parentName:"li"},"ATP2B4"),".")),(0,s.kt)("p",{parentName:"div"},"Should we include the stage as a covariate, or shouldn't we?"))),(0,s.kt)("h3",{id:"how-good-is-the-fit"},"How good is the fit?"),(0,s.kt)("p",null,"Before moving on we ought to check that the model is at all sensible for the data."),(0,s.kt)("p",null,"One way to do this is the ",(0,s.kt)("strong",{parentName:"p"},"quantile-quantile")," or *qq plot**. The qqplot is used to compare an expected distribution (which, in\nthis case, can be the fitted distribution of the expression values) to the actual observed distribution."),(0,s.kt)("p",null,"To do this let's examine the ",(0,s.kt)("strong",{parentName:"p"},"residuals")," - that is, the difference between the observed values and the fitted straight-line\nmodel. If the model is accurate, these residuals should look like 'gaussian noise' - i.e. be as if drawn from a Gaussian\ndistribution.  We can check this by comparing them to quantiles of a gaussian now:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'qq_data = tibble(\n    observed = sort( fit2$residuals ),\n    expected = qnorm(\n        1:nrow(data)/(nrow(data)+1),\n        sd = sigma( fit2 )              # sigma() is the fitted residual standard error\n    )\n)\nprint(\n    ggplot(\n        data = qq_data,\n        aes( x = observed, y = expected )\n    )\n    + geom_point()\n    + geom_abline( intercept = 0, slope = 1, colour = "red" )\n)\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"img",src:t(8258).Z,width:"400",height:"300"})),(0,s.kt)("p",null,"This plot says the fit is pretty good."),(0,s.kt)("p",null,"If you want to go further than this, one way is to compute a P-value comparing the distribution of residuals against the fitted\nmodel."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Challenge Question")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"Compute a P-value for the residuals against the fitted model."),(0,s.kt)("p",{parentName:"div"},(0,s.kt)("strong",{parentName:"p"},"Hint")," if the residuals are gaussian with variance ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"\u03c3"),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\sigma^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c3"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),", then their sum is gaussian with variance equal to ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"N"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"\u03c3"),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N\\sigma^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c3"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),".\nHow far out in the tail is the sum of observed residuals?"))),(0,s.kt)("h2",{id:"next-steps"},"Next steps"),(0,s.kt)("p",null,"Now let's look at a slightly different example using ",(0,s.kt)("a",{parentName:"p",href:"/chg-training-resources/statistical_modelling/regression_modelling/logistic_regression_1"},"logistic regression"),"."))}d.isMDXComponent=!0},25101:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/files/atp2b4_per_gene_data-df61916f2fd59d7401e9ce17d5c9e162.tsv"},73975:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/lm_confidence_interval_1-dc0ac489136133bd58e195ffea767cc1.png"},61347:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/lm_confidence_interval_2-a2966da70d7daeb4e95352d1c5162662.png"},8258:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/lm_qqplot-e15055e83ed82976edec7257378ce974.png"},27504:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/lm_refit_model_1-4a49e616c16ad61729637d1d5df6d0ed.png"},83918:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/lm_refit_tail-1418940e584b1e92d48dd465b50e2663.png"},93754:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/mean_per_genotype-adae91726137cbf2f4ee56a9d90bff81.png"},38803:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/normalised_per_genotype-aa52aa743b9b904fad26e6221d83948f.png"},48260:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/sampling_distribution_1-0cd85a000b0321c1c9ebb99eadb26729.png"},28723:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/sampling_distribution_shaded-0162baf05d477a64d12471f82f9cf169.png"}}]);